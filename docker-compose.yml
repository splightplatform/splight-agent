version: "3.7"

x-logging: &logging
  driver: "json-file"
  options:
    max-file: "5"
    max-size: 10m

services:
  splight-launcher:
    image: splight-launcher:latest
    container_name: splight-launcher
    restart: unless-stopped
    stdin_open: true
    tty: true
    build:
      context: .
      dockerfile: ./Dockerfile
    command: python src/main.py
    network_mode: "host" # TODO: remove this or move to dev mode
    volumes:
      - .:/code
      - /var/run/docker.sock:/var/run/docker.sock
      - $HOME/.aws/credentials:/root/.aws/credentials
      - $HOME/.splight/launcher_config:/root/.splight/launcher_config
    environment:
      - LAUNCHER_NAME=${LAUNCHER_NAME}

# networks:
#   splight:
#     name: splight
